<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Empire: Dawn of War</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; position: fixed; font-family: 'Georgia', serif; }
        
        .screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: none; z-index: 100; }

        /* –≠–ö–†–ê–ù –ó–ê–ì–†–£–ó–ö–ò */
        #loading-screen {
            display: flex; flex-direction: column; justify-content: space-between; align-items: center;
            background: url('bg.png') no-repeat center center / cover; z-index: 5000;
            padding: 60px 0; box-sizing: border-box;
        }

        .game-title {
            color: #ffd700; font-size: 32px; font-weight: bold; text-align: center;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.7), 3px 3px 5px #000;
            letter-spacing: 4px; text-transform: uppercase;
        }

        .loader-wrapper { width: 100%; display: flex; flex-direction: column; align-items: center; margin-bottom: 50px; }
        
        /* –ú–æ—â–Ω–∞—è —Ä–∞–º–∫–∞ */
        .loader-container {
            width: 80%; max-width: 400px; height: 22px;
            background: #1a1a1a; border: 3px solid #ffd700; 
            outline: 2px solid #333; border-radius: 4px;
            position: relative; overflow: hidden; box-shadow: 0 0 20px rgba(0,0,0,0.9);
        }

        .loader-bar {
            width: 0%; height: 100%;
            background: linear-gradient(180deg, #ffec8b 0%, #ffd700 50%, #b8860b 100%);
            position: relative; transition: width 0.1s linear;
        }

        .loader-bar::after {
            content: ''; position: absolute; top: 0; left: -100%; width: 60%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
            animation: shine 2s infinite;
        }

        @keyframes shine { to { left: 160%; } }
        .loading-text { color: #ffd700; margin-top: 15px; font-size: 14px; text-shadow: 1px 1px 2px #000; font-weight: bold; }

        /* –≠–ö–†–ê–ù –î–ò–ê–õ–û–ì–ê */
        #dialog-screen { 
            background: linear-gradient(to bottom, transparent 40%, #000 90%);
            display: none; flex-direction: column; justify-content: flex-end; align-items: center;
        }
        .character-img { height: 80%; position: absolute; bottom: 0; left: 0; z-index: 1; }
        .dialog-box { 
            width: 100%; background: rgba(15, 15, 15, 0.95); border-top: 4px solid #ffd700; 
            padding: 30px 20px; color: white; box-sizing: border-box; z-index: 10;
            box-shadow: 0 -10px 30px rgba(0,0,0,0.8);
        }
        .btn-game {
            background: linear-gradient(#8b0000, #4a0000); color: #ffd700; border: 2px solid #ffd700;
            padding: 12px 25px; margin: 10px 5px; font-weight: bold; border-radius: 3px; cursor: pointer;
            text-transform: uppercase; font-size: 14px;
        }

        /* –ö–ê–†–¢–ê */
        #map-screen { z-index: 50; }
        #game-map { width: 100%; height: 100%; background: #000; }
        .top-bar {
            position: absolute; top: 10px; left: 50%; transform: translateX(-50%);
            width: 95%; max-width: 450px; height: 45px;
            background: rgba(0,0,0,0.85); border: 2px solid #ffd700; border-radius: 5px;
            display: flex; justify-content: space-around; align-items: center; z-index: 1000;
        }
        .res { color: #ffd700; font-weight: bold; font-size: 14px; }
    </style>
</head>
<body>

    <div id="loading-screen" class="screen" style="display: flex;">
        <div class="game-title">EMPIRE:<br>DAWN OF WAR</div>
        <div class="loader-wrapper">
            <div class="loader-container">
                <div id="progress" class="loader-bar"></div>
            </div>
            <div id="percent-text" class="loading-text">–°–û–ó–î–ê–ù–ò–ï –ú–ò–†–ê: 0%</div>
        </div>
    </div>

    <div id="dialog-screen" class="screen">
        <img src="marshal_blank.png" class="character-img">
        <div class="dialog-box">
            <h3 style="color: #ffd700; margin: 0 0 10px 0; font-size: 22px;">–ö–ê–ô</h3>
            <p id="dialog-text" style="font-size: 18px; line-height: 1.4;">–ö–æ–º–∞–Ω–¥—É—é—â–∏–π, –º—ã –∑–∞–∫—Ä–µ–ø–∏–ª–∏—Å—å –Ω–∞ —ç—Ç–æ–π —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏. –ü–æ—Ä–∞ –æ—Å–Ω–æ–≤–∞—Ç—å –Ω–∞—à–µ –≤–µ–ª–∏—á–∏–µ. –ö–∞–∫–æ–µ –ø–µ—Ä–≤–æ–µ –∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∫–∞–∂–µ—Ç–µ –≤–æ–∑–≤–µ—Å—Ç–∏?</p>
            <div id="options">
                <button class="btn-game" onclick="startCampaign('sawmill')">–õ–ï–°–û–ü–ò–õ–ö–ê</button>
                <button class="btn-game" onclick="startCampaign('forge')">–ö–£–ó–ù–ò–¶–ê</button>
            </div>
        </div>
    </div>

    <div id="map-screen" class="screen">
        <div class="top-bar">
            <div class="res">üå≤ <span id="wood">500</span></div>
            <div class="res">‚öîÔ∏è <span id="steel">200</span></div>
            <div class="res">üí∞ <span id="gold">100</span></div>
        </div>
        <div id="game-map"></div>
    </div>

    <script>
        // –õ–û–ì–ò–ö–ê –ó–ê–ì–†–£–ó–ö–ò (7 —Å–µ–∫—É–Ω–¥)
        let progress = 0;
        const loadInterval = setInterval(() => {
            progress += 1;
            document.getElementById('progress').style.width = progress + '%';
            document.getElementById('percent-text').innerText = '–ü–û–î–ì–û–¢–û–í–ö–ê –í–û–ô–°–ö: ' + progress + '%';
            if (progress >= 100) {
                clearInterval(loadInterval);
                document.getElementById('loading-screen').style.display = 'none';
                document.getElementById('dialog-screen').style.display = 'flex';
            }
        }, 70);

        function startCampaign(building) {
            document.getElementById('dialog-screen').style.display = 'none';
            document.getElementById('map-screen').style.display = 'block';
            initMap();
        }

        function initMap() {
            const map = L.map('game-map', {
                crs: L.CRS.Simple,
                minZoom: -1,
                maxZoom: 1,
                zoomControl: false,
                attributionControl: false
            });

            const bounds = [[0, 0], [1000, 1000]]; // –ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞–∑–º–µ—Ä
            L.imageOverlay('map.png', bounds).addTo(map);
            map.fitBounds(bounds);
            map.setMaxBounds(bounds);

            // –†–µ–∂–∏–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (—á–µ—Ä–µ–∑ –¥–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ)
            map.on('contextmenu', (e) => {
                prompt("–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:", Math.round(e.latlng.lat) + ", " + Math.round(e.latlng.lng));
            });
        }
    </script>
</body>
</html>
