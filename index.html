<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Empire: Dawn of War</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; position: fixed; }
        
        /* –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ */
        #loading-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: url('bg.png') no-repeat center center / cover;
            z-index: 5000; display: flex; flex-direction: column; justify-content: center; align-items: center;
        }

        .loader-container {
            width: 70%; max-width: 300px; height: 14px;
            background: rgba(0,0,0,0.6); border: 2px solid #C0C0C0; /* –°–µ—Ä–µ–±—Ä—è–Ω—ã–µ –∫—Ä–∞—è */
            border-radius: 10px; position: relative; overflow: hidden; box-shadow: 0 0 10px rgba(0,0,0,0.5);
        }

        .loader-bar {
            width: 0%; height: 100%;
            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
            position: relative; transition: width 0.1s linear;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –±–ª–µ—Å–∫–∞ */
        .loader-bar::after {
            content: ''; position: absolute; top: 0; left: -100%; width: 50%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shine 1.5s infinite;
        }

        @keyframes shine {
            to { left: 150%; }
        }

        .loading-text { color: #C0C0C0; margin-top: 10px; font-family: serif; font-size: 12px; letter-spacing: 2px; }

        /* –ö–∞—Ä—Ç–∞ –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω */
        #map-screen { width: 100vw; height: 100vh; position: absolute; top: 0; left: 0; display: none; }
        #game-map { width: 100%; height: 100%; background: #000; }

        .top-bar {
            position: absolute; top: 10px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 400px; height: 40px;
            background: rgba(0,0,0,0.8); border: 1px solid #ffd700; border-radius: 8px;
            display: flex; justify-content: space-around; align-items: center; z-index: 1000;
        }
        .res { color: #ffd700; font-size: 13px; font-weight: bold; }
    </style>
</head>
<body>

    <div id="loading-screen">
        <div style="color:#ffd700; margin-bottom: 20px; font-size: 24px; text-shadow: 2px 2px #000;">–ó–ê–ì–†–£–ó–ö–ê –ò–ú–ü–ï–†–ò–ò</div>
        <div class="loader-container">
            <div id="progress" class="loader-bar"></div>
        </div>
        <div id="percent-text" class="loading-text">0%</div>
    </div>

    <div id="map-screen">
        <div class="top-bar">
            <div class="res">üå≤ <span id="wood">500</span></div>
            <div class="res">‚öîÔ∏è <span id="steel">200</span></div>
            <div class="res">üí∞ <span id="gold">100</span></div>
        </div>
        <div id="game-map"></div>
    </div>

    <script>
        // –õ–û–ì–ò–ö–ê –ó–ê–ì–†–£–ó–ö–ò
        let progress = 0;
        const interval = setInterval(() => {
            progress += 1;
            document.getElementById('progress').style.width = progress + '%';
            document.getElementById('percent-text').innerText = progress + '%';
            
            if (progress >= 100) {
                clearInterval(interval);
                finishLoading();
            }
        }, 70); // 70–º—Å * 100 = 7 —Å–µ–∫—É–Ω–¥

        function finishLoading() {
            document.getElementById('loading-screen').style.display = 'none';
            document.getElementById('map-screen').style.display = 'block';
            initMap();
        }

        // –õ–û–ì–ò–ö–ê –ö–ê–†–¢–´
        function initMap() {
            const map = L.map('game-map', {
                crs: L.CRS.Simple,
                minZoom: -1,
                maxZoom: 1,
                zoomControl: false,
                attributionControl: false,
                dragging: true,
                inertia: false // –£–±–∏—Ä–∞–µ—Ç "–¥–µ—Ä–≥–∞–Ω—å–µ" –ø—Ä–∏ –æ—Ç–ø—É—Å–∫–∞–Ω–∏–∏ –ø–∞–ª—å—Ü–∞
            });

            const img = new Image();
            img.src = 'map.png';
            img.onload = function() {
                const w = this.width;
                const h = this.height;
                const bounds = [[0, 0], [h, w]];
                L.imageOverlay('map.png', bounds).addTo(map);
                map.fitBounds(bounds);
                map.setMaxBounds(bounds);
            };

            // –ß—Ç–æ–±—ã –Ω–µ –≤—ã—Å–∫–∞–∫–∏–≤–∞–ª–æ –æ–∫–Ω–æ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –¥–≤–∏–∂–µ–Ω–∏–∏, 
            // –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é –∏–ª–∏ –¥–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ –±—É–¥—É—â–µ–º
            map.on('contextmenu', (e) => {
                alert(Math.round(e.latlng.lat) + ", " + Math.round(e.latlng.lng));
            });
        }
    </script>
</body>
</html>
