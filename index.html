<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Empire: Dawn of War</title>
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; touch-action: none; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; position: fixed; font-family: sans-serif; }

        /* –ó–ê–ì–†–£–ó–ö–ê */
        #loading-screen {
            position: fixed; inset: 0; background: url('bg.png') no-repeat center center / cover;
            display: flex; flex-direction: column; justify-content: space-between; align-items: center;
            z-index: 5000; padding: 50px 0;
        }
        .game-title { color: #ffd700; font-size: 32px; font-weight: bold; text-align: center; text-shadow: 2px 2px 10px #000; text-transform: uppercase; }
        .loader-wrap { width: 80%; max-width: 400px; display: flex; flex-direction: column; align-items: center; margin-bottom: 50px; }
        .loader-cont { width: 100%; height: 25px; background: #000; border: 3px solid #ffd700; border-radius: 5px; overflow: hidden; position: relative; }
        #progress { width: 0%; height: 100%; background: linear-gradient(180deg, #fff2ac, #ffd700, #b8860b); }

        /* –ò–ì–†–û–í–û–ô –ú–ò–† */
        #game-viewport {
            width: 100vw; height: 100vh; position: relative; overflow: hidden; display: none; background: #000;
        }

        /* –°–ê–ú–ê –ö–ê–†–¢–ê (–°–ª–æ–π, –∫–æ—Ç–æ—Ä—ã–π –º—ã –¥–≤–∏–≥–∞–µ–º) */
        #map-layer {
            position: absolute;
            width: 2500px; /* –†–∞–∑–º–µ—Ä –∫–∞—Ä—Ç—ã (–±–æ–ª—å—à–µ —ç–∫—Ä–∞–Ω–∞ –¥–ª—è —Å–∫—Ä–æ–ª–ª–∞) */
            height: 2500px;
            background: url('map.png') no-repeat center center;
            background-size: cover;
            cursor: grab;
            will-change: transform; /* –ü–æ–¥—Å–∫–∞–∑–∫–∞ –±—Ä–∞—É–∑–µ—Ä—É –¥–ª—è –ø–ª–∞–≤–Ω–æ—Å—Ç–∏ */
        }

        #map-layer:active { cursor: grabbing; }

        /* –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–≤–µ—Ä—Ö –∫–∞—Ä—Ç—ã */
        .ui-panel {
            position: absolute; top: 15px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 400px; height: 45px;
            background: rgba(0,0,0,0.8); border: 2px solid #ffd700; border-radius: 10px;
            display: flex; justify-content: space-around; align-items: center; z-index: 1000;
        }
        .res { color: #ffd700; font-weight: bold; }
    </style>
</head>
<body>

    <div id="loading-screen">
        <div class="game-title">EMPIRE:<br>DAWN OF WAR</div>
        <div class="loader-wrap">
            <div class="loader-cont"><div id="progress"></div></div>
            <div id="percent" style="color:#ffd700; margin-top:10px; font-weight:bold;">0%</div>
        </div>
    </div>

    <div id="game-viewport">
        <div class="ui-panel">
            <div class="res">üå≤ 500</div>
            <div class="res">‚öîÔ∏è 200</div>
            <div class="res">üí∞ 100</div>
        </div>
        <div id="map-layer"></div>
    </div>

    <script>
        // 1. –ó–ê–ì–†–£–ó–ö–ê
        let p = 0;
        let itv = setInterval(() => {
            p++;
            document.getElementById('progress').style.width = p+'%';
            document.getElementById('percent').innerText = p+'%';
            if(p >= 100) {
                clearInterval(itv);
                document.getElementById('loading-screen').style.display = 'none';
                document.getElementById('game-viewport').style.display = 'block';
                initCamera();
            }
        }, 70);

        // 2. –õ–û–ì–ò–ö–ê –ü–ï–†–ï–ú–ï–©–ï–ù–ò–Ø (–ö–ê–ú–ï–†–ê)
        function initCamera() {
            const viewport = document.getElementById('game-viewport');
            const map = document.getElementById('map-layer');
            
            let isDragging = false;
            let startX, startY;
            let currentX = -500; // –ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è (—Ü–µ–Ω—Ç—Ä –∫–∞—Ä—Ç—ã)
            let currentY = -500;

            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞—á–∞–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
            map.style.transform = `translate(${currentX}px, ${currentY}px)`;

            const startDrag = (e) => {
                isDragging = true;
                const touch = e.type === 'touchstart' ? e.touches[0] : e;
                startX = touch.clientX - currentX;
                startY = touch.clientY - currentY;
            };

            const moveDrag = (e) => {
                if (!isDragging) return;
                e.preventDefault();
                const touch = e.type === 'touchmove' ? e.touches[0] : e;
                
                currentX = touch.clientX - startX;
                currentY = touch.clientY - startY;

                // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (—á—Ç–æ–±—ã –Ω–µ —É–π—Ç–∏ –∑–∞ –∫—Ä–∞—è –∫–∞—Ä—Ç—ã)
                const minX = viewport.clientWidth - map.clientWidth;
                const minY = viewport.clientHeight - map.clientHeight;
                
                if (currentX > 0) currentX = 0;
                if (currentY > 0) currentY = 0;
                if (currentX < minX) currentX = minX;
                if (currentY < minY) currentY = minY;

                // –ò—Å–ø–æ–ª—å–∑—É–µ–º translate3d –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —á–µ—Ä–µ–∑ GPU
                map.style.transform = `translate3d(${currentX}px, ${currentY}px, 0)`;
            };

            const stopDrag = () => { isDragging = false; };

            // –°–ª—É—à–∞—Ç–µ–ª–∏ –¥–ª—è –º—ã—à–∫–∏
            viewport.addEventListener('mousedown', startDrag);
            window.addEventListener('mousemove', moveDrag);
            window.addEventListener('mouseup', stopDrag);

            // –°–ª—É—à–∞—Ç–µ–ª–∏ –¥–ª—è –ø–∞–ª—å—Ü–µ–≤
            viewport.addEventListener('touchstart', startDrag);
            viewport.addEventListener('touchmove', moveDrag, { passive: false });
            viewport.addEventListener('touchend', stopDrag);
        }
    </script>
</body>
</html>
